/* ===========================
   Reset & Base
   =========================== */
*, *::before, *::after {
  box-sizing: border-box;
}
html, body {
  height: 100%;
  margin: 0;
  font-family: system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
}

/* ===========================
   ðŸŽ¨ MASTER THEME COLORS
   =========================== */
:root {
  --color-1: #94e8b4; /* light accent */
  --color-2: #72bda3; /* mid accent */
  --color-3: #5e8c61; /* primary green */
  --color-4: #4e6151; /* dark neutral */
  --color-5: #3b322c; /* very dark base */
  --color-6: #800000; /* deep maroon (special actions) */
}

/* ===========================
   Derived Palette (Light)
   =========================== */
:root {
  --bg:#fff;
  --surface-1: color-mix(in srgb, var(--color-1) 10%, white 90%);
  --surface-2: color-mix(in srgb, var(--color-1) 15%, white 85%);
  --surface-hover: color-mix(in srgb, var(--color-1) 25%, white 75%);
  --border: color-mix(in srgb, var(--color-4) 25%, white 75%);
  --text: var(--color-5);
  --text-muted: color-mix(in srgb, var(--color-4) 50%, white 50%);
  --primary: var(--color-3);
  --primary-contrast:#fff;
  --accent: var(--color-2);
  --accent-contrast: var(--color-5);
  --user-bubble-bg: var(--color-4);
  --user-bubble-text: var(--primary-contrast);
  --assistant-bubble-bg: var(--color-1);
  --assistant-bubble-text: var(--color-5);
  --danger: hsl(0 72% 48%);
  --danger-contrast:#fff;
  --ring: color-mix(in srgb, var(--color-2) 60%, transparent);
}

/* ===========================
   Derived Palette (Dark Mode)
   =========================== */
body.dark-mode {
  --bg: var(--color-5);
  --surface-1: color-mix(in srgb, var(--color-4) 80%, black 20%);
  --surface-2: color-mix(in srgb, var(--color-4) 65%, black 35%);
  --surface-hover: color-mix(in srgb, var(--color-4) 50%, black 50%);
  --border: color-mix(in srgb, var(--color-4) 40%, black 60%);
  --text:#f2f2f2;
  --text-muted: color-mix(in srgb, #f2f2f2 60%, var(--color-4) 40%);
  --primary: color-mix(in srgb, var(--color-3) 80%, white 20%);
  --primary-contrast:#fff;
  --accent: color-mix(in srgb, var(--color-2) 90%, white 10%);
  --accent-contrast: var(--color-5);
  --user-bubble-bg: var(--color-4);
  --user-bubble-text:#fff;
  --assistant-bubble-bg: color-mix(in srgb, var(--color-1) 30%, var(--color-4) 70%);
  --assistant-bubble-text:#fff;
  --ring: color-mix(in srgb, var(--color-2) 70%, transparent);
}

/* ===========================
   Base Setup
   =========================== */
html { color-scheme: light; }
body.dark-mode { color-scheme: dark; }
body { background:var(--bg); color:var(--text); }

/* ===========================
   Layout
   =========================== */
.app-container { display:flex; height:100vh; width:100%; overflow:hidden; }
.sidebar { flex:0 0 30%; min-width:150px; max-width:400px;
  transition: width .3s ease, opacity .3s ease;
  background:var(--surface-1); border-right:1px solid var(--border);
  display:flex; flex-direction:column; min-height:0; color:var(--text);}
.sidebar.hidden { width:0; opacity:0; }

.sidebar-header {
  height:60px; padding:0 14px;
  background:linear-gradient(180deg, color-mix(in srgb, var(--primary), black 6%) 0%, var(--primary) 100%);
  color:var(--primary-contrast); font-weight:600;
  display:flex; align-items:center; gap:8px;
}
.sidebar-icon { fill:currentColor; }

.main-content { width:70%; transition:width .3s ease; }
.new-chat {
  margin:8px; padding:10px 14px;
  background-color: var(--color-6);
  color:var(--primary-contrast); border:none; border-radius:8px;
  font-weight:600; cursor:pointer;
}

.chat-list { overflow-y:auto; padding:10px; flex:1; background:var(--surface-1); }
.chat-item {
  position:relative; display:flex; justify-content:space-between; align-items:center;
  padding:10px; padding-right:64px; border-radius:8px; gap:8px; cursor:pointer; margin-bottom:8px; color:var(--text);
}
.chat-item:hover { background:var(--surface-hover); }

.chat-title { font-weight:600; font-size:14px; color:var(--text); white-space:nowrap; overflow:hidden; text-overflow:ellipsis; max-width:60ch; }
.chat-subtitle { font-size:12px; color:var(--text-muted); margin-top:6px; white-space:nowrap; overflow:hidden; text-overflow:ellipsis; }

.delete-btn {
  position:absolute; right:8px; top:50%; transform:translateY(-50%);
  width:32px; height:32px; padding:4px; border-radius:6px;
  border:none; background:transparent; color:var(--color-6);
  display:flex; align-items:center; justify-content:center;
  cursor:pointer; transition:background-color .12s, color .12s, transform .06s, box-shadow .08s;
}
.chat-item:hover .delete-btn,
.delete-btn:focus {
  background:var(--color-6); color:#fff;
  transform:translateY(-50%) scale(1.03);
  box-shadow:0 2px 6px rgba(0,0,0,0.12);
}

.chat-window { flex:1; display:flex; flex-direction:column; background:var(--surface-2);}
.messages { flex:1; padding:16px; overflow-y:auto; display:flex; flex-direction:column; gap:12px; }

.message {
  max-width:85%; padding:.75rem 1rem;
  border-radius:1.25rem; line-height:1.4;
  white-space:pre-wrap; word-wrap:break-word;
  font-size:.95rem; box-shadow:0 2px 6px rgba(0,0,0,0.08);
}
.message.user { background:var(--user-bubble-bg); color:var(--user-bubble-text); border-bottom-right-radius:.3rem; align-self:flex-end;}
.message.assistant { background:var(--assistant-bubble-bg); color:var(--assistant-bubble-text); border-bottom-left-radius:.3rem; align-self:flex-start; }
.message .msg-text {
  position: relative;         /* allows absolute positioning inside */
  background: #f1f1f1;        /* example bubble background */
  padding: 0.5rem 2rem 1rem 0.75rem; /* extra right/bottom padding for timestamp */
  border-radius: 0.5rem;
  display: inline-block;
  max-width: 75%;             /* keep bubbles reasonable */
  word-break: break-word;
}

.msg-time {
  position: absolute;
  bottom: 0.25rem;
  right: 0.5rem;
  font-size: 0.7rem;
  color: #888;
}

/* ===========================
   Input Area
   =========================== */
.input-area {
  display:flex; align-items:center; gap:8px; padding:12px;
  border-top:1px solid var(--border); background:var(--surface-1);
}
.input-area textarea {
  flex:1; min-height:42px; max-height:200px;
  padding:10px; border-radius:8px; border:1px solid var(--border);
  background:var(--bg); color:var(--text); resize:vertical; font-size:14px;
}
.send-btn {
  width:40px; height:40px;
  background: var(--color-6);
  color:var(--primary-contrast); border:none; border-radius:8px;
  display:flex; align-items:center; justify-content:center;
  cursor:pointer;
}
.send-btn svg { width:20px; height:20px; }

/* ===========================
   Header Area
   =========================== */
.chat-header {
  display:flex; align-items:center; justify-content:space-between;
  height:60px; padding:0.5rem 1rem;
  background:linear-gradient(180deg, color-mix(in srgb, var(--primary), black 6%) 0%, var(--primary) 100%);
  color:var(--primary-contrast); font-weight:600;
}
.chat-header .chat-title { font-weight:600; font-size:16px; color:#fff; white-space:nowrap; }

.header-controls { display:flex; align-items:center; gap:0.5rem; }

/* Apply to ALL header buttons */
.chat-header button,
.header-controls button,
#themeBtn,
#toggleThemeBtn,
#toggleSidebarBtn {
  background: var(--color-6);
  color: var(--primary-contrast);
  border: none;
  border-radius: 8px;
  width: 40px;
  height: 40px;
  display: flex;
  align-items: center;
  justify-content: center;
  cursor: pointer;
  transition: background-color .2s, transform .1s;
}
.chat-header button:hover,
.header-controls button:hover,
#themeBtn:hover,
#toggleThemeBtn:hover,
#toggleSidebarBtn:hover {
  background: var(--accent);
}

/* Force outline SVGs to use currentColor */
.chat-header button svg,
.header-controls button svg,
#themeBtn svg,
#toggleThemeBtn svg,
#toggleSidebarBtn svg {
  stroke: currentColor !important;
  fill: none !important;
  width:22px; height:22px;
  stroke-width:2;
  stroke-linecap:round;
  stroke-linejoin:round;
}

/* ===========================
   Palette Dropdown
   =========================== */
.theme-dropdown { position:relative; display:inline-block; }
#paletteSelector {
  position:absolute; top:110%; right:0; z-index:1000;
  background:var(--surface-1); color:var(--text);
  border:1px solid var(--border); border-radius:6px;
  padding:.25rem .5rem; font-size:14px;
  box-shadow:0 4px 8px rgba(0,0,0,0.15);
}
#paletteSelector.hidden { display:none; }

/* ===========================
   Responsive
   =========================== */
@media (max-width:768px){
  .sidebar{width:30%;}
  .main-content{width:85%;}
}
@media (max-width:599.98px){
  .chat-header{flex-wrap:wrap;}
  .chat-header .chat-title{flex-basis:100%; margin-bottom:4px;}
  .header-controls button{width:32px;height:32px;}
}

